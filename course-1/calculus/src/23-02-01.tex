\subsection{Интегральные суммы}
\begin{definition}
    $f:E\rightarrow \R;\ f$ \textit{равномерно непрерывна}, если:
    
    $\forall \varepsilon>0\ \underset{=\delta(\varepsilon)}{\exists\delta} >0: \forall x, y\in E: |x-y|<\delta\Rightarrow |f(x)-f(y)|<\varepsilon$.
\end{definition}

\begin{remark}
    $f:E\rightarrow \R;\ f$  \textit{непрерывна во всех точках}, если: 
    
    $\forall x\in E\ \forall \varepsilon>0\ \underset{=\delta(x, \varepsilon)}{\exists\delta} >0:\forall y\in E:|x-y|<\delta\Rightarrow |f(x)-f(y)|<\varepsilon$.
\end{remark}

\begin{statement}
    $f:E\rightarrow \R$ равномерно непрерывна $\Rightarrow f$ непрерывна на $E$.
\end{statement}

\begin{example}
    \begin{enumerate}
        \item[]
        \item[0.] $f(x)=x$.
        \item $f(x) = \sin x$ – равномерно непрерывна на $\R: |\sin x-\sin y|\leq |x-y|,\ \delta=\varepsilon$ подходит.
        \item $f:E\rightarrow \R$ \textit{липшицева с константой} $L$, если $\forall x, y\in E: |f(x)-f(y)|\leq L\cdot|x-y|$.
        
        $f$ равномерно непрерывна на $E:\ \delta=\frac{\varepsilon}{L}$ подходит.
        \item $f(x)=x^2$ – \underline{не} равномерно непрерывна на $\R$.

        Возьмем $\varepsilon=1$ и проверим, что никакое $\delta>0$ не подходит:

        $y=x+\frac{\delta}{2},\ |x-y|<\delta;\ f(x)-f(y)=y^2-x^2=(x+\frac{\delta}{2})^2-x^2=x\delta+\frac{\delta^2}{4}>x\delta >1$ при $x>\frac{1}{\delta}$.
        \item $f(x)=\frac{1}{x}$ на $(0,+\infty)$ – \underline{не} равномерно непрерывна.

        Возьмем $\varepsilon=1$ и проверим, что никакое $\delta>0$ не подходит:

        $y=\frac{\delta}{2}$ и $x=\delta,\ |x-y|<\delta;\ f(y)-f(x)=\frac{2}{\delta}-\frac{1}{\delta}=\frac{1}{\delta}>1$ при $\delta<1$ не подходит.

        Если $\delta\geq 1$, то $y=\frac{1}{2},\ x=1,$ то $f(y)-f(x)=1$.
    \end{enumerate}
\end{example}

\begin{theorem} \textbf{Теорема Кантора}

$f:[a, b]\rightarrow \R$ непрерывна во всех точках. Тогда $f$ равномерно непрерывна на $[a, b]$.
\end{theorem}

\begin{proof}
    Зафиксируем $\varepsilon>0$ и предположим, что никакое $\delta>0$ не подходит. 
    
    В частности, $\delta =1$ не подходит $\Rightarrow \exists x_1, y_1\in [a, b]: |x_1-y_1|<\delta$ и $|f(x_1)-f(y_1)|\geq \varepsilon$

    $\delta =\frac{1}{2}$ не подходит $\Rightarrow \exists x_2, y_2\in [a, b]: |x_2-y_2|<\delta$ и $|f(x_2)-f(y_2)|\geq \varepsilon$

    ...

    $\delta =\frac{1}{n}$ не подходит $\Rightarrow \exists x_n, y_n\in [a, b]: |x_n-y_n|<\delta$ и $|f(x_n)-f(y_n)|\geq \varepsilon$

    $x_n\ -$ ограниченная последовательность $\overset{\text{th Б.-В.}}{\Rightarrow} $ выберем сходящуюся подпоследовательность $x_{n_k}\rightarrow c$

    $a\leq x_{n_k}\leq b\Rightarrow c\in [a, b]$ $f$ непрерывна в $c\Rightarrow f(x_{n_k})\rightarrow f(c)$

    $c\leftarrow x_{n_k}-\frac{1}{n_k}< y_{n_k}<x_{n_k}+\frac{1}{n_k}\rightarrow c\Rightarrow y_{n_k}\rightarrow c\Rightarrow f(y_{n_k})\rightarrow f(c)$

    Тогда $f(x_{n_k})-f(y_{n_k})\rightarrow f(c)-f(c)=0$, но $|f(x_{n_k})-f(y_{n_k})|\geq \varepsilon$, получили противоречие.
\end{proof}

\begin{definition}
    $f:E\rightarrow \R;\ \omega_f(\delta):=\sup \{|f(x)-f(y)| \mid x, y\in E $ и $ |x-y|<\delta \}$ для $\delta\geq 0$.

    $\omega_f(\delta)$ – \textit{модуль непрерывности}.
\end{definition}

\begin{statement} \textbf{Свойства:}
    \begin{enumerate}
        \item $\omega_f(0)=0$.
        \item $\omega_f\geq 0$.
        \item $\omega_f$ нестрого возрастает.
        \item $|f(x)-f(y)|\leq \omega_f(|x-y|)$.
        \item Если $f$ липшицева с константой $L$, то $\omega_f(\delta)\leq L\delta$.

        Комментарий: $(|f(x)-f(y)|\leq L|x-y|\leq L\delta$, если $|x-y|\leq \delta$; то есть все числа (и $\sup$ в том числе) не превышают $L\delta)$
        \item $f$ равномерно непрерывна на $E\Leftrightarrow \omega_f$ непрерывна в нуле (то есть $\lim\limits_{\delta\rightarrow0_+}\omega_f(\delta)=0$).
        \begin{proof}
            $\Rightarrow:\ f$ равномерно непрерывна. Возьмем $\varepsilon>0$, для него:
            
            $\exists \delta >0\ \forall x, y\in E: |x-y|<\delta\Rightarrow |f(x)-f(y)|<\varepsilon$ 
            
            Тогда если $|x-y|\leq\frac{\delta}{2}$, то $|f(x)-f(y)|<\varepsilon\Rightarrow\omega_f(\frac{\delta}{2})\leq \varepsilon\Rightarrow w_f(\alpha)\leq\varepsilon\ \forall \alpha <\frac{\delta}{2}\Rightarrow \lim\limits_{\delta\rightarrow0_+}\omega_f(\delta)=0$.

            $\Leftarrow:$ Возьмем $\varepsilon>0$ и такую $\delta>0$, что $\omega_f(\delta)<\frac{\varepsilon}{2}\Rightarrow $ если $|x-y|<\delta$, то $|f(x)-f(y)|\leq \frac{\varepsilon}{2}<\varepsilon$.
        \end{proof}
        \item $f\in C[a, b]\Leftrightarrow \lim\limits_{\delta\rightarrow0_+}\omega_f(\delta)=0$.

        Комментарий: $\Rightarrow:$ th Кантора; $\Leftarrow:$ 6 свойство.
    \end{enumerate}
\end{statement}

\begin{definition}
    $[a, b]:\ a=x_0<x_1<...<x_n=b;\ \tau=\{x_0, ..., x_n\}$

    $\tau\ -$ \textit{дробление (разбиение, пунктир)} отрезка $[a, b]$. 
\end{definition}

\begin{definition}
    \textit{Ранг дробления} $|\tau|:=\max\{x_1-x_0, ..., x_n-x_{n-1}\}$ (самый длинный отрезок дробления).
\end{definition}

\begin{definition}
    \textit{Оснащение дробления} $\xi=\{\xi_1, ..., \xi_n\},\ \xi_k\in[x_{k-1}, x_k]\ \forall k$.
\end{definition}

\begin{definition}
    \textit{Интегральная сумма (сумма Римана)}: $S(f, \tau, \xi)=\sum\limits_{k=1}^n f(\xi_k)(x_k-x_{k-1})$.
\end{definition}

\begin{theorem} \textbf{Теорема об интегральных суммах}

    $f\in C[a, b]$. Тогда $\bigg|\int\limits_{a}^b f-S(f, \tau, \xi)\bigg|\leq (b-a)\cdot \omega_f(|\tau|)$.
\end{theorem}

\begin{proof}
    $\Delta:=\int\limits_{a}^b f-S(f, \tau, \xi)
    =\int\limits_{a}^b f-\sum\limits_{k=1}^n f(\xi_k)(x_k-x_{k-1}) 
    =\sum\limits_{k=1}^n \int\limits_{x_{k-1}}^{x_k} f-\sum\limits_{k=1}^n f(\xi_k)(x_k-x_{k-1})
    =\sum\limits_{k=1}^n \bigg(\int\limits_{x_{k-1}}^{x_k} f- f(\xi_k)(x_k-x_{k-1})\bigg)
    =\sum\limits_{k=1}^n \int\limits_{x_{k-1}}^{x_k} \bigg(f(t)-f(\xi_k)\bigg)\,dt$

    $|\Delta|\leq \sum\limits_{k=1}^n \int\limits_{x_{k-1}}^{x_k} \underbrace{\bigg|f(t)-f(\xi_k)\bigg|}_{\leq\omega_f(x_k-x_{k-1})\leq \omega_f(|\tau|)}\,dt\leq \sum\limits_{k=1}^n \int_{x_{k-1}}^{x_k} \omega_f(|\tau|)=\omega_f(|\tau|)\sum\limits_{k=1}^n(x_k-x_{k-1})=\omega_f(|\tau|)(b-a)$.
\end{proof}

\begin{corollary}
    \begin{enumerate}
        \item[]
        \item $\forall\varepsilon>0\ \exists \delta>0\ \forall$ дробления ранга $<\delta$ и $\forall$ его оснащения: $\bigg|\int\limits_{a}^b f-S(f, \tau, \xi)\bigg|<\varepsilon$.
        \item $\tau_n\ -$ последовательность дроблений, т.ч. если $|\tau_n|\rightarrow 0$, то $S(f, \tau, \xi)\rightarrow \int\limits_{a}^b f$.
    \end{enumerate}
\end{corollary}

\begin{example}
    $S_p(n):=1^p+2^p+...+n^p,\ p\geq 0$

    Хотим посчитать $\lim\frac{S_p(n)}{n^{p+1}}=\frac{1}{p+1}$.

    Возьмем непрерывную $f(x)=x^p$ и воспользуемся теоремой для нее:

    $\frac{S_p(n)}{n^{p+1}}=\frac{1}{n}\sum\limits_{k=1}^n \frac{k^p}{n^p}=[x_k=\frac{k}{n},\ [a, b]=[0, 1],\ x_k-x_{k+1}=\frac{1}{n},\ \xi_k=x_k]=\frac{1}{n}\sum\limits_{k=1}^n f(\frac{k}{n})=S(f, \tau, \xi)\rightarrow \int\limits_0^1 f(x)\,dx=\int\limits_0^1 x^p\,dx=\left.\frac{x^{p+1}}{p+1}\right|_0^1=\frac{1}{p+1}$


\end{example}

\begin{definition}
    $f: [a, b]\rightarrow \R,\ f\ -$ \textit{интегрируема по Риману} и $I\ -$ ее интеграл, если $\forall \varepsilon >0\ \exists\delta>0:\forall$ дробления ранга $<\delta$ и $\forall$ оснащения $\bigg|S(f,\tau, \xi) - I\bigg|<\varepsilon$.
\end{definition}

\begin{remark}
    Любая непрерывная функция $-$ такая.
\end{remark}

\begin{remark}
    Берем дробления на равные отрезки $x_k-x_{k-1}=\frac{b-a}{n},\ x_k=a+k\cdot \frac{b-a}{n}$ и $\xi_k=x_k$:

    $S(f, \tau, \xi)=\sum\limits_{k=1}^nf(x_k)\cdot\frac{b-a}{n}=\frac{b-a}{n}\cdot \sum\limits_{k=1}^nf(x_k)\rightarrow \int\limits_a^b$

    Теперь рассмотрим $\xi'_k=x_{k-1}:$
    
    $S(f, \tau, \xi')=\sum\limits_{k=1}^nf(x_{k-1})\cdot\frac{b-a}{n}=\frac{b-a}{n}\cdot \sum\limits_{k=0}^{n-1}f(x_k)\rightarrow \int\limits_a^b$

    Сумма площадей трапеций: 
    
    $\sum\limits_{k=1}^n\frac{f(x_{k-1})+f(x_k)}{2}\cdot (x_k-x_{k-1})=\frac{b-a}{n}\cdot \sum\limits_{k=1}^n\frac{f(x_{k-1})+f(x_k))}{2}
    =\frac{b-a}{n}\cdot\bigg(\frac{f(x_0)}{2}+\frac{f(x_n)}{2}+\sum\limits_{k=1}^{n-1}f(x_k)\bigg)$
\end{remark}

\begin{lemma}
    $f\in C^2[\alpha, \beta]$. Тогда $\Delta:=\int\limits_\alpha^\beta f-\frac{f(\alpha)+f(\beta)}{2}(\beta-\alpha)=-\frac{1}{2}\int\limits_\alpha^\beta f''(t)(t-\alpha)(\beta-t)dt$.
\end{lemma}

\begin{proof}
    $\gamma := \frac{\alpha + \beta}{2}$ 
    
    $\int\limits_\alpha^\beta f(t)dt=\int\limits_\alpha^\beta f(t)(t-\gamma)'dt=\underbrace{\left. f(t)(t-\gamma)\right|^\beta_\alpha}_{f(\beta)\cdot\frac{\beta-\alpha}{2}-f(\alpha)\cdot(-\frac{\beta-\alpha}{2})=\frac{f(\beta)+f(\alpha)}{2}(\beta-\alpha)} -\int\limits_\alpha^\beta f'(t)(t-\gamma)dt$

    Рассмотрим $((t-\alpha)(\beta-t))'=(-t^2+(\beta+\alpha)t-\alpha\beta)'=-2t+(\beta+\alpha)=-2(t-\gamma)$

    $\Delta=-\int\limits_\alpha^\beta f'(t)(t-\gamma)dt
    =\frac{1}{2}\int\limits_\alpha^\beta f'(t)((t-\alpha)(\beta-t))'dt
    =\underbrace{\left.\frac{1}{2}f'(t)(t-\alpha)(\beta-t)\right|^\beta_\alpha}_{0}-\frac{1}{2}\int\limits_\alpha^\beta f''(t)(t-\alpha)(\beta-t)dt$
\end{proof}

\begin{theorem}
    \textbf{Оценка погрешности в формуле трапеций}

    $f\in C^2[a, b]$. Тогда $\bigg|\int\limits_\alpha^\beta f-\sum\limits_{k=1}^n\frac{f(x_{k-1})+f(x_k)}{2}(x_k-x_{k-1})\bigg|\leq \frac{|\tau|^2}{8}\cdot \int\limits_\alpha^\beta|f''|$.
\end{theorem}

\begin{proof}
    $\Delta =\int\limits_\alpha^\beta -\sum\limits_{k=1}^n
    =\sum\limits_{k=1}^n\bigg(\int\limits_{x_{k-1}}^{x_k} f - \frac{f(x_k)+f(x_{k-1})}{2}\cdot(x_k-x_{k-1})\bigg)
    =-\frac{1}{2}\sum\limits_{k=1}^n \int\limits_{x_{k-1}}^{x_k} f'' (t)(t-x_{k-1})(x_k-t)dt$

    $|\Delta|\leq \frac{1}{2}\sum\limits_{k=1}^n \int\limits_{x_{k-1}}^{x_k} |f'' (t)|(t-x_{k-1})(x_k-t)dt\overset{(*)}{\leq} \frac{|\tau|^2}{8}\sum\limits_{k=1}^n\int\limits_{x_{k-1}}^{x_k} |f''(t)|dt=\frac{|\tau|^2}{8}\int\limits_{a}^{b} |f''(t)|dt$

    (*) $(t-x_{k-1})(x_k-t)\leq (\frac{x_k-x_{k-1}}{2})^2=\frac{1}{4}(x_k-x_{k-1})^2\leq \frac{|\tau|^2}{4}$
\end{proof}

\begin{theorem}
    \textbf{Формула Эйлера-Маклорена для второй производной}

    $f\in C^2[m, n]$. Тогда $\sum\limits_{k=m}^n f(k)=\frac{f(m)+f(n)}{2}+\int\limits_m^n f(t)dt+\frac{1}{2}\int\limits_m^nf''(t)\cdot \{t\}\cdot(1-\{t\})dt$.
\end{theorem}

\begin{proof}
    $\int\limits_{k-1}^k f(t)dt-\frac{f(k-1)+f(k)}{2}
    =-\frac{1}{2}\int\limits_{k-1}^k f''(t)\underbrace{(t-(k-1))}_{\{t\}}\underbrace{(k-t)}_{1-\{t\}}dt
    =-\frac{1}{2}\int\limits_{k-1}^k f''(t)\cdot\{t\}\cdot(1-\{t\})dt$

    Суммирование по $k$ от $m+1$ до $n$: $\underbrace{\sum\limits_{k=m+1}^n\int\limits_{k-1}^k f(t)dt}_{\int\limits_m^n f(t)dt}-\underbrace{\sum\limits_{k=m+1}^n\frac{f(k-1)+f(k)}{2}}_{\sum\limits_{k=m}^nf(k)-\frac{f(m)+f(n)}{2}}=$
    
    $=-\frac{1}{2}\underbrace{\sum\limits_{k=m+1}^n\int\limits_{k-1}^k f''(t)\cdot\{t\}\cdot(1-\{t\})dt}_{\int\limits_{m}^n f''(t)\cdot\{t\}\cdot(1-\{t\})dt}$
\end{proof}

\begin{example}
    \begin{enumerate}
        \item[]
        \item $S_p(n):=1^p+2^p+...+n^p,\ f(t)=t^p,\ p>-1,\ m=1,\ n=n,\ f''(t)=p(p-1)\cdot t^{p-2}$
        
        $S_p(n)=\frac{f(1)+f(n)}{2}+\int\limits_1^nf(t)dt+\frac{1}{2}\int\limits_1^nf''(t)\cdot \{t\}\cdot (1-\{t\})dt
        =\frac{1}{2}+\frac{n^p}{2}+\underbrace{\int\limits_1^nt^pdt}_{=\left.\frac{t^{p+1}}{p+1}\right|_1^n=\frac{n^{p+1}}{p+1}-\frac{1}{p+1}}+\frac{1}{2}\int\limits_1^np(p-1)t^{p-2})\{t\}(1-\{t\})dt$

        \begin{enumerate}
            \item[$\circ$] Случай $p\in (-1, 1)$: $S_p(n)=\frac{n^{p+1}}{p+1}+\frac{n^p}{2}+\mathcal{O}(1)$

            $0<\int\limits_1^nt^{p-2}\underbrace{\{t\}(1-\{t\})}_{\leq \frac{1}{4}}dt\leq \frac{1}{4}\underbrace{\int\limits_1^nt^{p-2}dt}_{=\left.\frac{t^{p-1}}{p-1}\right|_1^n=\frac{1}{1-p}-\frac{n^{p-1}}{1-p}<\frac{1}{1-p}}$, то есть интеграл оценивается константой
            \item[$\circ$] Случай $p > (-1, 1)$: $S_p(n)=\frac{n^{p+1}}{p+1}+\frac{n^p}{2}+o(n^{p-1})$

            $0<\int\limits_1^nt^{p-2}\cdot \{t\}\cdot (1-\{t\})dt\leq \left.\frac{t^{p-1}}{p-1}\right|_1^n=\frac{n^{p-1}-1}{p-1}$
        \end{enumerate}
        
        \item \textit{Гармонические числа} $H_n:=1+\frac{1}{2}+...+\frac{1}{n}$.

        $f(t)=\frac{1}{t},\ m=1,\ n=n,\ f''(t)=\frac{2}{t^3}$

        $H_n=\frac{1+\frac{1}{n}}{2}+\underbrace{\int\limits_1^n\frac{dt}{t}}_{\left.\ln t\right|_1^n=\ln n}+\underbrace{\frac{1}{2}\int\limits_1^n\frac{2\{t\}(1-\{t\})}{t^3}dt}_{:=a_n}$

        $H_n=\ln n + \frac{1}{2}+\frac{1}{2n}+a_n$

        $a_n\ -$ возрастающая последовательность; $a_n\leq \int\limits_1^n\frac{1}{4}\frac{dt}{t^3}=\left.\frac{1}{4}(-\frac{1}{2t^2})\right|_1^n=\frac{1}{4}(\frac{1}{2}-\frac{1}{2n^2})\leq \frac{1}{8}$

        $a_n$ возрастающая и ограниченная $\Rightarrow \exists \lim a_n=a\leq \frac{1}{8}\Rightarrow a_n=a+o(1)$

        $H_n=\ln n + \underbrace{(a+\frac{1}{2})}_{=:\gamma}+o(1)$

        $\gamma\ -$ \textit{постоянная Эйлера}, $\gamma\approx 0, 5772156649...$ 

        \item Формула Стирлинга: $n!\sim n^n\cdot e^{-n}\sqrt{2\pi n}$

        $\ln n!=\sum\limits_{k=1}^n\ln k,\ f(t)=\ln t,\ f''(t) =-\frac{1}{t^2},\ m=1,\ n=n$

        $\ln n!=\underbrace{\frac{\ln 1 + \ln n}{2}}_{=\frac{1}{2}\ln n}+\underbrace{\int\limits_1^n\ln t\ dt}_{=n\cdot \ln n - n+1 (*)}+\underbrace{\frac{1}{2}\int\limits_1^n \frac{\{t\}(1-\{t\})}{t^2}dt}_{=:b_n}\Rightarrow $

        $(*)\int\limits_1^n\ln t\ dt=t\cdot \ln t\left.\right|_1^n-\int\limits_1^n t\frac{1}{t} dt=n\cdot \ln n-n+1$

        $\Rightarrow \ln n!=n\cdot \ln n -n+\frac{1}{2}\ln n +1-b_n$

        $b_n\ -$ возрастающая последовательность: $b_{n+1}-b_n=\frac{1}{2}\int\limits_n^{n+1}\frac{\{t\}(1-\{t\})}{t^2} dt>0$

        $b_n\ -$ ограниченная последовательность: $b_n\leq\frac{1}{8}\int\limits_1^{n}\frac{dt}{t^2}=\frac{1}{8}(-\frac{1}{t})\left.\right|_1^n=\frac{1}{8}-\frac{1}{8n}<\frac{1}{8}$

        Тогда существует $\lim b_n=b$ и $b_n=b+o(1)$.

        $\ln n!=n\cdot \ln n - n + \frac{1}{2}\ln n+1-b+o(1)\Rightarrow n!=n^n\cdot e^{-n}\cdot\sqrt{n} \cdot e^{1-b}\cdot \underbrace{e^{o(1)}}_{1+o(1)\sim 1}\sim n^n\cdot e^{-n}\cdot\sqrt{n} \cdot C$

        Найдем $C$. Рассмотрим $\frac{4^n}{\sqrt{\pi n}}\sim\binom{2n}{n}=\frac{(2n)!}{(n!)^2}\sim\frac{(2n)^{2n}\cdot e^{-2n}\cdot\sqrt{2n}\cdot C}{(n^n\cdot e^{-n}\sqrt{n}\cdot C)^2}=\frac{2^{2n\cdot \sqrt{2n}\cdot C}}{\sqrt{n}\cdot \sqrt{n} \cdot C^2}=\frac{4^n\cdot\sqrt{2}}{\sqrt{n}\cdot C}$

        Тогда $\frac{4^n}{\sqrt{\pi n}}\sim \frac{4^n\cdot \sqrt{2}}{\sqrt{n}\cdot C}\Leftrightarrow \frac{1}{\sqrt{\pi}}\sim \frac{\sqrt{2}}{C}\Rightarrow C=\sqrt{2\pi}$
    \end{enumerate}
\end{example}